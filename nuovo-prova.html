<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Calcolatore Regime Forfettario</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
       /* CSS per il calcolatore */

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
}

.container {
    max-width: 800px;
    margin: auto;
    padding: 20px;
}

h1 {
    text-align: center;
}

.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
}

input[type="number"],
input[type="date"],
select {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
}

#calcola-btn {
    display: block;
    width: 100%;
    padding: 10px;
    background-color: #007bff;
    color: #fff;
    border: none;
    cursor: pointer;
    font-size: 16px;
}

#calcola-btn:hover {
    background-color: #0056b3;
}

#risultati {
    margin-top: 20px;
}

#risultati table {
    width: 100%;
    border-collapse: collapse;
}

#risultati th,
#risultati td {
    border: 1px solid #ddd;
    padding: 8px;
}

#risultati th {
    background-color: #f2f2f2;
    text-align: left;
}

.highlight-yellow {
    background-color: #fff9c4;
}

.highlight-blue {
    background-color: #bbdefb;
}

.tabs {
    list-style-type: none;
    padding: 0;
    display: flex;
    cursor: pointer;
    margin-top: 20px;
}

.tab-link {
    padding: 10px 20px;
    background-color: #f2f2f2;
    margin-right: 5px;
}

.tab-link.current {
    background-color: #fff;
    border-bottom: 2px solid #007bff;
}

.tab-content {
    display: none;
    margin-top: 20px;
}

.tab-content.current {
    display: block;
}

.highlight-yellow-text {
    background-color: #fff9c4;
    padding: 2px 5px;
}

.highlight-blue-text {
    background-color: #bbdefb;
    padding: 2px 5px;
}

@media screen and (max-width: 600px) {
    .tabs {
        flex-direction: column;
    }

    .tab-link {
        margin-bottom: 5px;
    }
}
    </style>
</head>
<body>
    <div class="container">
        <h1>Calcolatore Regime Forfettario</h1>
        <form id="calculator-form">
            <div class="form-group">
                <label for="anno-riferimento">Anno di Riferimento:</label>
                <select id="anno-riferimento">
                    <option value="2024">2024</option>
                    <!-- Predisposto per anni futuri -->
                </select>
            </div>

            <div class="form-group">
                <label for="reddito-lordo">Reddito Lordo (€):</label>
                <input type="number" id="reddito-lordo" required>
            </div>

            <div class="form-group">
                <label for="aliquota-imposta">Aliquota dell'Imposta Sostitutiva:</label>
                <select id="aliquota-imposta">
                    <option value="5">5%</option>
                    <option value="15">15%</option>
                </select>
            </div>

            <div class="form-group">
                <label for="coefficiente-redditivita">Coefficiente di Redditività:</label>
                <select id="coefficiente-redditivita">
                    <option value="86">86%</option>
                    <option value="78">78%</option>
                    <option value="67">67%</option>
                    <option value="40">40%</option>
                    <!-- Aggiungi altri coefficienti se necessario -->
                </select>
            </div>

            <div class="form-group">
                <label for="cassa-inps">Cassa di Riferimento INPS:</label>
                <select id="cassa-inps">
                    <option value="gestione-separata">Gestione Separata INPS</option>
                    <option value="commercianti">INPS Commercianti</option>
                    <option value="artigiani">INPS Artigiani</option>
                </select>
            </div>

            <div class="form-group" id="data-apertura-group" style="display: none;">
                <label for="data-apertura">Data di Apertura della Partita IVA:</label>
                <input type="date" id="data-apertura">
            </div>

            <div class="form-group" id="riduzione-35-group" style="display: none;">
                <input type="checkbox" id="riduzione-35">
                <label for="riduzione-35">Applica riduzione del 35% sui contributi INPS</label>
            </div>

            <button type="button" id="calcola-btn">Calcola</button>
        </form>

        <div id="risultati" style="display: none;">
            <!-- I risultati verranno mostrati qui -->
        </div>

        <div id="menu-schede" style="display: none;">
            <ul class="tabs">
                <li class="tab-link current" data-tab="tab-1">Come si Calcolano?</li>
                <li class="tab-link" data-tab="tab-2">Scadenza Pagamenti</li>
                <li class="tab-link" data-tab="tab-3">Dettaglio Pagamenti</li>
            </ul>

            <div id="tab-1" class="tab-content current">
                <!-- Spiegazione dettagliata dei calcoli -->
            </div>
            <div id="tab-2" class="tab-content">
                <!-- Dettaglio delle scadenze con tabelle -->
            </div>
            <div id="tab-3" class="tab-content">
                <!-- Riepilogo dettagliato dei pagamenti -->
            </div>
        </div>
    </div>

    <script>
       // JavaScript per il calcolatore

document.addEventListener('DOMContentLoaded', function() {
    const annoRiferimentoSelect = document.getElementById('anno-riferimento');
    const cassaInpsSelect = document.getElementById('cassa-inps');
    const riduzione35Group = document.getElementById('riduzione-35-group');
    const dataAperturaGroup = document.getElementById('data-apertura-group');
    const calcolaBtn = document.getElementById('calcola-btn');
    const risultatiDiv = document.getElementById('risultati');
    const menuSchede = document.getElementById('menu-schede');

    cassaInpsSelect.addEventListener('change', function() {
        if (this.value === 'commercianti' || this.value === 'artigiani') {
            riduzione35Group.style.display = 'block';
            dataAperturaGroup.style.display = 'block';
        } else {
            riduzione35Group.style.display = 'none';
            dataAperturaGroup.style.display = 'none';
        }
    });

    calcolaBtn.addEventListener('click', function() {
        calcola();
    });

    function calcola() {
        // Ottenere i valori di input
        const annoRiferimento = parseInt(document.getElementById('anno-riferimento').value) || new Date().getFullYear();
        const redditoLordo = parseInt(document.getElementById('reddito-lordo').value) || 0;
        const aliquotaImposta = parseInt(document.getElementById('aliquota-imposta').value) || 0;
        const coefficienteRedditivita = parseInt(document.getElementById('coefficiente-redditivita').value) || 0;
        const cassaInps = document.getElementById('cassa-inps').value;
        const riduzione35 = document.getElementById('riduzione-35').checked;
        const dataAperturaInput = document.getElementById('data-apertura').value;

        let mesiAttivi = 12; // Default
        let dataApertura = null;

        if ((cassaInps === 'commercianti' || cassaInps === 'artigiani') && dataAperturaInput) {
            dataApertura = new Date(dataAperturaInput);
            const dataFineAnno = new Date(annoRiferimento, 11, 31);
            mesiAttivi = ((dataFineAnno.getFullYear() - dataApertura.getFullYear()) * 12) + (dataFineAnno.getMonth() - dataApertura.getMonth()) + 1;
            if (mesiAttivi > 12) mesiAttivi = 12;
            if (mesiAttivi < 0) mesiAttivi = 0;
        }

        // Calcolo del reddito netto
        const redditoNetto = Math.round(redditoLordo * (coefficienteRedditivita / 100));

        // Calcolo dell'imposta sostitutiva
        const impostaSostitutiva = Math.round(redditoNetto * (aliquotaImposta / 100));

        // Calcolo dei contributi INPS
        let contributiInps = 0;
        let contributiFissi = 0;
        let contributiVariabili = 0;
        let aliquotaContributiva = 0;
        let sogliaReddito = 18415;

        // Importi e aliquote per anno di riferimento
        // Qui puoi aggiornare gli importi per gli anni futuri
        let contributiFissiAnnuiCommercianti = 4515.43;
        let aliquotaVariabileCommercianti = 24.48;
        let contributiFissiAnnuiArtigiani = 4427.04;
        let aliquotaVariabileArtigiani = 24;
        let aliquotaGestioneSeparata = 26.23; // Aggiornata al 2023

        if (annoRiferimento === 2024) {
            // Aggiorna gli importi per il 2024 se necessario
            // Per ora usiamo gli stessi importi del 2023
        } else if (annoRiferimento === 2025) {
            // Aggiorna gli importi per il 2025
            // contributiFissiAnnuiCommercianti = ...;
            // aliquotaVariabileCommercianti = ...;
            // contributiFissiAnnuiArtigiani = ...;
            // aliquotaVariabileArtigiani = ...;
            // aliquotaGestioneSeparata = ...;
        }

        if (cassaInps === 'gestione-separata') {
            aliquotaContributiva = aliquotaGestioneSeparata;
            contributiInps = Math.round(redditoNetto * (aliquotaContributiva / 100));
        } else if (cassaInps === 'commercianti' || cassaInps === 'artigiani') {
            let contributiFissiAnnui = cassaInps === 'commercianti' ? contributiFissiAnnuiCommercianti : contributiFissiAnnuiArtigiani;
            let aliquotaVariabile = cassaInps === 'commercianti' ? aliquotaVariabileCommercianti : aliquotaVariabileArtigiani;

            // Riduzione del 35% sui contributi fissi se applicabile
            if (riduzione35) {
                contributiFissiAnnui = contributiFissiAnnui * 0.65;
            }

            // Calcolo contributi fissi proporzionati
            contributiFissi = Math.round((contributiFissiAnnui / 12) * mesiAttivi);

            // Calcolo contributi variabili
            if (redditoNetto > sogliaReddito) {
                const eccedenza = redditoNetto - sogliaReddito;
                contributiVariabili = Math.round(eccedenza * (aliquotaVariabile / 100));
            }

            contributiInps = contributiFissi + contributiVariabili;
            aliquotaContributiva = aliquotaVariabile;
        }

        // Calcolo degli acconti (imposta sostitutiva e contributi INPS)
        const accontoImposta = Math.round(impostaSostitutiva);
        let accontoInps = 0;

        if (cassaInps === 'gestione-separata') {
            accontoInps = Math.round(contributiInps * 0.80);
        } else if (cassaInps === 'commercianti' || cassaInps === 'artigiani') {
            accontoInps = contributiVariabili; // Gli acconti riguardano solo i contributi variabili
        }

        // Mostrare i risultati
        risultatiDiv.style.display = 'block';
        menuSchede.style.display = 'block';

        risultatiDiv.innerHTML = `
            <h2>Risultati</h2>
            <table>
                <tr>
                    <th>Descrizione</th>
                    <th>Importo</th>
                </tr>
                <tr>
                    <td>Reddito Lordo</td>
                    <td>${formatCurrency(redditoLordo)}</td>
                </tr>
                <tr>
                    <td>Reddito Netto (anno ${annoRiferimento})</td>
                    <td>${formatCurrency(redditoNetto)}</td>
                </tr>
                <tr>
                    <td>Imposta Sostitutiva (${aliquotaImposta}%) sul ${annoRiferimento}</td>
                    <td>${formatCurrency(impostaSostitutiva)}</td>
                </tr>
                <tr>
                    <td>Acconto Imposta Sostitutiva (100%) sul ${annoRiferimento +1}<br>(calcolato con metodo storico)</td>
                    <td>${formatCurrency(accontoImposta)}</td>
                </tr>
                <tr>
                    <td>Contributi INPS sul ${annoRiferimento}</td>
                    <td>${formatCurrency(contributiInps)}</td>
                </tr>
                <tr>
                    <td>Acconto Contributi INPS sul ${annoRiferimento +1}<br>(calcolato con metodo storico)</td>
                    <td>${formatCurrency(accontoInps)}</td>
                </tr>
            </table>
        `;

        // Popolare le schede
        popolaSchede({
            annoRiferimento,
            redditoLordo,
            redditoNetto,
            impostaSostitutiva,
            contributiInps,
            accontoImposta,
            accontoInps,
            contributiFissi,
            contributiVariabili,
            mesiAttivi,
            dataApertura,
            cassaInps,
            riduzione35,
            aliquotaImposta,
            coefficienteRedditivita,
            aliquotaContributiva,
            sogliaReddito
        });
    }

    function popolaSchede(dati) {
        // Funzione per evidenziare il testo
        function highlight(text, className) {
            return `<span class="${className}">${text}</span>`;
        }

        // Formatta l'anno di riferimento e quello successivo
        const annoSuccessivo = dati.annoRiferimento + 1;

        // Scheda "Scadenza Pagamenti"
        const tab2 = document.getElementById('tab-2');
        tab2.innerHTML = `
            <h3>Scadenze dei Pagamenti</h3>
            <table>
                <tr>
                    <th>Data</th>
                    <th>Importo</th>
                    <th>Descrizione</th>
                </tr>
                ${getScadenzePagamentiRows(dati)}
            </table>
        `;

        // Sposta il testo precedente in "Dettaglio Pagamenti"
        const tab1 = document.getElementById('tab-1');
        tab1.innerHTML = `
            <!-- Spiegazione dettagliata dei calcoli -->
            ${getTestoComeSiCalcolano(dati)}
        `;

        const tab3 = document.getElementById('tab-3');
        tab3.innerHTML = `
            ${getDettaglioPagamentiText(dati)}
        `;
    }

    function getScadenzePagamentiRows(dati) {
        const rows = [];

        // Saldo imposta sostitutiva
        rows.push(`
            <tr>
                <td>30 Giugno ${dati.annoRiferimento + 1}</td>
                <td>${formatCurrency(dati.impostaSostitutiva)}</td>
                <td>${highlight('Saldo Imposta Sostitutiva sul ' + dati.annoRiferimento, 'highlight-yellow-text')}</td>
            </tr>
        `);

        // Acconto imposta sostitutiva in due rate
        const accontoImpostaPrimaRata = Math.round(dati.accontoImposta / 2);
        const accontoImpostaSecondaRata = dati.accontoImposta - accontoImpostaPrimaRata;

        rows.push(`
            <tr>
                <td>30 Giugno ${dati.annoRiferimento + 1}</td>
                <td>${formatCurrency(accontoImpostaPrimaRata)}</td>
                <td>${highlight('Prima Rata Acconto Imposta Sostitutiva sul ' + (dati.annoRiferimento + 1), 'highlight-blue-text')}</td>
            </tr>
            <tr>
                <td>30 Novembre ${dati.annoRiferimento + 1}</td>
                <td>${formatCurrency(accontoImpostaSecondaRata)}</td>
                <td>${highlight('Seconda Rata Acconto Imposta Sostitutiva sul ' + (dati.annoRiferimento + 1), 'highlight-blue-text')}</td>
            </tr>
        `);

        // Contributi INPS
        if (dati.cassaInps === 'gestione-separata') {
            // Saldo contributi INPS
            rows.push(`
                <tr>
                    <td>30 Giugno ${dati.annoRiferimento + 1}</td>
                    <td>${formatCurrency(dati.contributiInps)}</td>
                    <td>${highlight('Saldo Contributi INPS sul ' + dati.annoRiferimento, 'highlight-yellow-text')}</td>
                </tr>
            `);

            // Acconto contributi INPS in due rate (80%)
            const accontoInpsPrimaRata = Math.round(dati.accontoInps / 2);
            const accontoInpsSecondaRata = dati.accontoInps - accontoInpsPrimaRata;

            rows.push(`
                <tr>
                    <td>30 Giugno ${dati.annoRiferimento + 1}</td>
                    <td>${formatCurrency(accontoInpsPrimaRata)}</td>
                    <td>${highlight('Prima Rata Acconto Contributi INPS sul ' + (dati.annoRiferimento + 1), 'highlight-blue-text')}</td>
                </tr>
                <tr>
                    <td>30 Novembre ${dati.annoRiferimento + 1}</td>
                    <td>${formatCurrency(accontoInpsSecondaRata)}</td>
                    <td>${highlight('Seconda Rata Acconto Contributi INPS sul ' + (dati.annoRiferimento + 1), 'highlight-blue-text')}</td>
                </tr>
            `);
        } else if (dati.cassaInps === 'commercianti' || dati.cassaInps === 'artigiani') {
            // Contributi fissi in 4 rate
            const rataFissa = Math.round(dati.contributiFissi / 4);

            const scadenze = [
                { data: `16 Maggio ${dati.annoRiferimento}`, importo: rataFissa },
                { data: `20 Agosto ${dati.annoRiferimento}`, importo: rataFissa },
                { data: `16 Novembre ${dati.annoRiferimento}`, importo: rataFissa },
                { data: `16 Febbraio ${dati.annoRiferimento + 1}`, importo: rataFissa },
            ];

            scadenze.forEach((scadenza, index) => {
                rows.push(`
                    <tr>
                        <td>${scadenza.data}</td>
                        <td>${formatCurrency(scadenza.importo)}</td>
                        <td>Rata ${index + 1} Contributi Fissi INPS</td>
                    </tr>
                `);
            });

            // Contributi variabili (saldo)
            if (dati.contributiVariabili > 0) {
                rows.push(`
                    <tr>
                        <td>30 Giugno ${dati.annoRiferimento + 1}</td>
                        <td>${formatCurrency(dati.contributiVariabili)}</td>
                        <td>${highlight('Saldo Contributi Variabili INPS sul ' + dati.annoRiferimento, 'highlight-yellow-text')}</td>
                    </tr>
                `);

                // Acconto contributi variabili (100% dei variabili)
                rows.push(`
                    <tr>
                        <td>30 Giugno ${dati.annoRiferimento + 1}</td>
                        <td>${formatCurrency(dati.contributiVariabili)}</td>
                        <td>${highlight('Acconto Contributi Variabili INPS sul ' + (dati.annoRiferimento + 1), 'highlight-blue-text')}</td>
                    </tr>
                `);
            }
        }

        return rows.join('');
    }

    function getTestoComeSiCalcolano(dati) {
        // Funzione per generare il testo di "Come si Calcolano?"
        // (Puoi adattare il testo in base alle tue esigenze)
        // Inserisci il testo dettagliato qui
        return `
            <p>In regime forfettario paghi l'imposta sostitutiva, che nel tuo caso è del ${dati.aliquotaImposta}%.</p>
            <p>L'imposta come i contributi li paghi non sul totale incassato ma sul ${dati.coefficienteRedditivita}% (che è il coefficiente di redditività del tuo codice ATECO).</p>
            <p>Quindi paghi il ${dati.aliquotaImposta}% di imposta e il ${dati.aliquotaContributiva}% di contributi INPS non sul totale incassato (${formatCurrency(dati.redditoLordo)}) ma sul tuo incassato per il coefficiente di redditività.</p>
            <p><strong>${formatCurrency(dati.redditoLordo)} x ${dati.coefficienteRedditivita}% = ${formatCurrency(dati.redditoNetto)} (reddito netto imponibile)</strong></p>
            <p>Nota bene:</p>
            <ul>
                <li>Se nell'anno di riferimento hai versato dei contributi, questi vengono detratti dal tuo reddito netto.</li>
                <li>Se avevi versato gli acconti nell'anno precedente, questi vengono scalati dai saldi che devi versare quest'anno.</li>
            </ul>
            <h3>Esempio di calcolo:</h3>
            <p>Per un incasso di ${formatCurrency(dati.redditoLordo)}, il ${dati.coefficienteRedditivita}% corrisponde a ${formatCurrency(dati.redditoNetto)}. Su questo importo, dovrai pagare:</p>
            <ul>
                <li>Imposta sostitutiva: ${dati.aliquotaImposta}% su ${formatCurrency(dati.redditoNetto)}, che equivale a ${formatCurrency(dati.impostaSostitutiva)}.</li>
                <li>Contributi INPS: ${dati.aliquotaContributiva}% su ${formatCurrency(dati.redditoNetto)}, che equivale a ${formatCurrency(dati.contributiInps)}.</li>
            </ul>
            <p>Quindi, a livello di saldo, pagherai ${highlight(formatCurrency(dati.impostaSostitutiva + dati.contributiInps), 'highlight-yellow-text')} (di cui ${formatCurrency(dati.impostaSostitutiva)} di imposta e ${formatCurrency(dati.contributiInps)} di contributi).</p>
            <h3>Acconti:</h3>
            <p>Oltre al saldo, dovrai versare anche gli acconti per l’anno successivo:</p>
            <ul>
                <li>Imposta sostitutiva: pagherai il 100% dell'importo del saldo come acconto, quindi ulteriori ${highlight(formatCurrency(dati.accontoImposta), 'highlight-blue-text')}.</li>
                <li>Contributi INPS: pagherai ${getPercentualeAcconto(dati)}% dell'importo ${getAccontoBaseText(dati)} come acconto, quindi ${highlight(formatCurrency(dati.accontoInps), 'highlight-blue-text')}.</li>
            </ul>
            <h3>Totale complessivo:</h3>
            <ul>
                <li>Saldo totale: ${highlight(formatCurrency(dati.impostaSostitutiva + dati.contributiInps), 'highlight-yellow-text')} (di cui ${formatCurrency(dati.impostaSostitutiva)} di imposta e ${formatCurrency(dati.contributiInps)} di contributi)</li>
                <li>Acconti totali: ${highlight(formatCurrency(dati.accontoImposta + dati.accontoInps), 'highlight-blue-text')} (di cui ${formatCurrency(dati.accontoImposta)} di imposta e ${formatCurrency(dati.accontoInps)} di contributi)</li>
                <li>Importo complessivo (saldo + acconti): ${highlight(formatCurrency(dati.impostaSostitutiva + dati.contributiInps + dati.accontoImposta + dati.accontoInps), 'highlight-yellow-text')}</li>
            </ul>
            <p>Questi importi sono indicativi e, in sede di dichiarazione dei redditi, verranno calcolati con precisione.</p>
        `;
    }

    function getDettaglioPagamentiText(dati) {
        // Funzione per generare il testo di "Dettaglio Pagamenti"
        // Inserisci qui il testo precedente che era in "Scadenza Pagamenti"
        return `
            <h3>Riepilogo dei Pagamenti:</h3>
            <p><strong>Dettaglio dei pagamenti per l'anno ${dati.annoRiferimento}</strong></p>
            <p>Hai guadagnato ${formatCurrency(dati.redditoLordo)} nel ${dati.annoRiferimento}.</p>
            <h4>Calcolo del Reddito Netto:</h4>
            <p>Reddito Lordo (${formatCurrency(dati.redditoLordo)}) x Coefficiente di Redditività (${dati.coefficienteRedditivita}%) = ${formatCurrency(dati.redditoNetto)}</p>
            <h4>Calcolo dell'Imposta Sostitutiva:</h4>
            <p>Reddito Netto (${formatCurrency(dati.redditoNetto)}) x Aliquota Imposta Sostitutiva (${dati.aliquotaImposta}%) = ${formatCurrency(dati.impostaSostitutiva)}</p>
            <h4>Calcolo dei Contributi INPS (${getCassaInpsNome(dati.cassaInps)}):</h4>
            ${getDettaglioContributi(dati)}
            ${getRiepilogoTotali(dati)}
            <p>Nota: Gli acconti sono un anticipo sulle tasse e contributi dell'anno successivo (${dati.annoRiferimento + 1}) e non rappresentano un costo aggiuntivo.</p>
        `;
    }

    function getContributiText(dati) {
        if (dati.cassaInps === 'gestione-separata') {
            return `${dati.aliquotaContributiva}% su ${formatCurrency(dati.redditoNetto)}, che equivale a ${formatCurrency(dati.contributiInps)}.`;
        } else {
            return `Contributi fissi: ${formatCurrency(dati.contributiFissi)}. ${dati.contributiVariabili > 0 ? 'Contributi variabili: ' + formatCurrency(dati.contributiVariabili) + '.' : ''}`;
        }
    }

    function getPercentualeAcconto(dati) {
        if (dati.cassaInps === 'gestione-separata') {
            return '80';
        } else {
            return '100';
        }
    }

    function getAccontoBaseText(dati) {
        if (dati.cassaInps === 'gestione-separata') {
            return 'del saldo';
        } else {
            return 'dei contributi variabili';
        }
    }

    function getCassaInpsNome(cassa) {
        if (cassa === 'commercianti') {
            return 'Commercianti';
        } else if (cassa === 'artigiani') {
            return 'Artigiani';
        } else {
            return 'Gestione Separata INPS';
        }
    }

    function getDettaglioContributi(dati) {
        if (dati.cassaInps === 'gestione-separata') {
            return `<p>Contributi INPS: ${dati.aliquotaContributiva}% su ${formatCurrency(dati.redditoNetto)}, che equivale a ${formatCurrency(dati.contributiInps)}.</p>`;
        } else {
            let testo = `<p>Contributi Fissi (stabiliti da INPS): ${formatCurrency(dati.contributiFissi)}</p>`;
            if (dati.contributiVariabili > 0) {
                testo += `<p>Contributi Variabili: ${formatCurrency(dati.contributiVariabili)} (calcolati sul reddito eccedente ${formatCurrency(dati.sogliaReddito)})</p>`;
            }
            testo += `<p>Totale Contributi INPS = ${formatCurrency(dati.contributiInps)}</p>`;
            return testo;
        }
    }

    function getRiepilogoTotali(dati) {
        const totaleTasseContributi = dati.impostaSostitutiva + dati.contributiInps;
        const totaleAcconti = dati.accontoImposta + dati.accontoInps;
        const totaleDaVersare = totaleTasseContributi + totaleAcconti;
        const percentualeTasse = Math.round((totaleTasseContributi / dati.redditoLordo) * 100);
        const percentualeAcconti = Math.round((totaleAcconti / dati.redditoLordo) * 100);
        const percentualeTotale = Math.round((totaleDaVersare / dati.redditoLordo) * 100);

        return `
            <h3>Riepilogo dei Pagamenti:</h3>
            <ul>
                <li><strong>Totale tasse e contributi effettivi sul ${dati.annoRiferimento}:</strong> ${formatCurrency(totaleTasseContributi)} (circa il ${percentualeTasse}% del tuo reddito lordo)</li>
                <li><strong>Totale acconti per il ${dati.annoRiferimento + 1}:</strong> ${formatCurrency(totaleAcconti)} (circa il ${percentualeAcconti}% del tuo reddito lordo)</li>
                <li><strong>Totale da versare complessivamente:</strong> ${formatCurrency(totaleDaVersare)} (circa il ${percentualeTotale}% del tuo reddito lordo)</li>
            </ul>
        `;
    }

    function formatCurrency(amount) {
        return amount.toLocaleString('it-IT', { minimumFractionDigits: 0 }) + '€';
    }

    // Gestione delle schede
    const tabs = document.querySelectorAll('.tab-link');
    const tabContents = document.querySelectorAll('.tab-content');

    tabs.forEach(function(tab) {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');

            tabs.forEach(function(node) {
                node.classList.remove('current');
            });

            tabContents.forEach(function(node) {
                node.classList.remove('current');
            });

            this.classList.add('current');
            document.getElementById(tabId).classList.add('current');
        });
    });
});

    </script>
</body>
</html>
