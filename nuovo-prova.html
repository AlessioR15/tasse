<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Calcolatore Regime Forfettario</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
       /* CSS per il calcolatore */

body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
}

.container {
    max-width: 800px;
    margin: auto;
    padding: 20px;
}

h1 {
    text-align: center;
}

.form-group {
    margin-bottom: 15px;
}

label {
    display: block;
}

input[type="number"],
input[type="date"],
select {
    width: 100%;
    padding: 8px;
    margin-top: 5px;
}

#calcola-btn {
    display: block;
    width: 100%;
    padding: 10px;
    background-color: #007bff;
    color: #fff;
    border: none;
    cursor: pointer;
    font-size: 16px;
}

#calcola-btn:hover {
    background-color: #0056b3;
}

#risultati {
    margin-top: 20px;
}

#risultati table {
    width: 100%;
    border-collapse: collapse;
}

#risultati th,
#risultati td {
    border: 1px solid #ddd;
    padding: 8px;
}

#risultati th {
    background-color: #f2f2f2;
}

.highlight-yellow {
    background-color: #fff9c4;
}

.highlight-blue {
    background-color: #bbdefb;
}

.tabs {
    list-style-type: none;
    padding: 0;
    display: flex;
    cursor: pointer;
    margin-top: 20px;
}

.tab-link {
    padding: 10px 20px;
    background-color: #f2f2f2;
    margin-right: 5px;
}

.tab-link.current {
    background-color: #fff;
    border-bottom: 2px solid #007bff;
}

.tab-content {
    display: none;
    margin-top: 20px;
}

.tab-content.current {
    display: block;
}

@media screen and (max-width: 600px) {
    .tabs {
        flex-direction: column;
    }

    .tab-link {
        margin-bottom: 5px;
    }
}

    </style>
</head>
<body>
    <div class="container">
        <h1>Calcolatore Regime Forfettario</h1>
        <form id="calculator-form">
            <div class="form-group">
                <label for="reddito-lordo">Reddito Lordo (€):</label>
                <input type="number" id="reddito-lordo" required>
            </div>

            <div class="form-group">
                <label for="aliquota-imposta">Aliquota dell'Imposta Sostitutiva:</label>
                <select id="aliquota-imposta">
                    <option value="5">5%</option>
                    <option value="15">15%</option>
                </select>
            </div>

            <div class="form-group">
                <label for="coefficiente-redditivita">Coefficiente di Redditività:</label>
                <select id="coefficiente-redditivita">
                    <option value="86">86%</option>
                    <option value="78">78%</option>
                    <option value="67">67%</option>
                    <option value="40">40%</option>
                    <!-- Aggiungi altri coefficienti se necessario -->
                </select>
            </div>

            <div class="form-group">
                <label for="cassa-inps">Cassa di Riferimento INPS:</label>
                <select id="cassa-inps">
                    <option value="gestione-separata">Gestione Separata INPS</option>
                    <option value="commercianti">INPS Commercianti</option>
                    <option value="artigiani">INPS Artigiani</option>
                </select>
            </div>

            <div class="form-group" id="data-apertura-group" style="display: none;">
                <label for="data-apertura">Data di Apertura della Partita IVA:</label>
                <input type="date" id="data-apertura">
            </div>

            <div class="form-group" id="riduzione-35-group" style="display: none;">
                <input type="checkbox" id="riduzione-35">
                <label for="riduzione-35">Applica riduzione del 35% sui contributi INPS</label>
            </div>

            <button type="button" id="calcola-btn">Calcola</button>
        </form>

        <div id="risultati" style="display: none;">
            <!-- I risultati verranno mostrati qui -->
        </div>

        <div id="menu-schede" style="display: none;">
            <ul class="tabs">
                <li class="tab-link current" data-tab="tab-1">Come si Calcolano?</li>
                <li class="tab-link" data-tab="tab-2">Scadenza Pagamenti</li>
                <li class="tab-link" data-tab="tab-3">Dettaglio Pagamenti</li>
            </ul>

            <div id="tab-1" class="tab-content current">
                <!-- Spiegazione dettagliata dei calcoli -->
            </div>
            <div id="tab-2" class="tab-content">
                <!-- Dettaglio delle scadenze con tabelle -->
            </div>
            <div id="tab-3" class="tab-content">
                <!-- Riepilogo dettagliato dei pagamenti -->
            </div>
        </div>
    </div>

    <script>
       // JavaScript per il calcolatore

document.addEventListener('DOMContentLoaded', function() {
    const cassaInpsSelect = document.getElementById('cassa-inps');
    const riduzione35Group = document.getElementById('riduzione-35-group');
    const dataAperturaGroup = document.getElementById('data-apertura-group');
    const calcolaBtn = document.getElementById('calcola-btn');
    const risultatiDiv = document.getElementById('risultati');
    const menuSchede = document.getElementById('menu-schede');

    cassaInpsSelect.addEventListener('change', function() {
        if (this.value === 'commercianti' || this.value === 'artigiani') {
            riduzione35Group.style.display = 'block';
            dataAperturaGroup.style.display = 'block';
        } else {
            riduzione35Group.style.display = 'none';
            dataAperturaGroup.style.display = 'none';
        }
    });

    calcolaBtn.addEventListener('click', function() {
        calcola();
    });

    function calcola() {
        // Ottenere i valori di input
        const redditoLordo = parseInt(document.getElementById('reddito-lordo').value) || 0;
        const aliquotaImposta = parseInt(document.getElementById('aliquota-imposta').value) || 0;
        const coefficienteRedditivita = parseInt(document.getElementById('coefficiente-redditivita').value) || 0;
        const cassaInps = document.getElementById('cassa-inps').value;
        const riduzione35 = document.getElementById('riduzione-35').checked;
        const dataAperturaInput = document.getElementById('data-apertura').value;

        let mesiAttivi = 12; // Default per Gestione Separata
        let dataApertura = null;

        if ((cassaInps === 'commercianti' || cassaInps === 'artigiani') && dataAperturaInput) {
            dataApertura = new Date(dataAperturaInput);
            const dataFineAnno = new Date(dataApertura.getFullYear(), 11, 31);
            mesiAttivi = ((dataFineAnno.getFullYear() - dataApertura.getFullYear()) * 12) + (dataFineAnno.getMonth() - dataApertura.getMonth()) + 1;
        }

        // Calcolo del reddito netto
        const redditoNetto = Math.round(redditoLordo * (coefficienteRedditivita / 100));

        // Calcolo dell'imposta sostitutiva
        const impostaSostitutiva = Math.round(redditoNetto * (aliquotaImposta / 100));

        // Calcolo dei contributi INPS
        let contributiInps = 0;
        let contributiFissi = 0;
        let contributiVariabili = 0;

        if (cassaInps === 'gestione-separata') {
            contributiInps = Math.round(redditoNetto * 0.2607);
        } else if (cassaInps === 'commercianti' || cassaInps === 'artigiani') {
            const sogliaReddito = 18415;
            let aliquotaVariabile = cassaInps === 'commercianti' ? 0.2448 : 0.24;
            let contributiFissiAnnui = cassaInps === 'commercianti' ? 4515 : 4427;

            // Riduzione del 35% se applicabile
            if (riduzione35) {
                contributiFissiAnnui = Math.round(contributiFissiAnnui * 0.65);
                aliquotaVariabile = parseFloat((aliquotaVariabile * 0.65).toFixed(4));
            }

            // Calcolo contributi fissi proporzionati
            contributiFissi = Math.round((contributiFissiAnnui / 12) * mesiAttivi);

            // Calcolo contributi variabili
            if (redditoNetto > sogliaReddito) {
                contributiVariabili = Math.round((redditoNetto - sogliaReddito) * aliquotaVariabile);
            }

            contributiInps = contributiFissi + contributiVariabili;
        }

        // Calcolo degli acconti (imposta sostitutiva e contributi INPS)
        const accontoImposta = Math.round(impostaSostitutiva);
        const accontoInps = cassaInps === 'gestione-separata' ? Math.round(contributiInps * 0.80) : Math.round(contributiInps);

        // Mostrare i risultati
        risultatiDiv.style.display = 'block';
        menuSchede.style.display = 'block';

        risultatiDiv.innerHTML = `
            <h2>Risultati</h2>
            <table>
                <tr>
                    <th>Descrizione</th>
                    <th>Importo (€)</th>
                </tr>
                <tr>
                    <td>Reddito Netto</td>
                    <td>${redditoNetto}</td>
                </tr>
                <tr class="highlight-yellow">
                    <td>Imposta Sostitutiva (${aliquotaImposta}%)</td>
                    <td>${impostaSostitutiva}</td>
                </tr>
                <tr class="highlight-yellow">
                    <td>Contributi INPS</td>
                    <td>${contributiInps}</td>
                </tr>
                <tr class="highlight-blue">
                    <td>Acconto Imposta Sostitutiva (100%)</td>
                    <td>${accontoImposta}</td>
                </tr>
                <tr class="highlight-blue">
                    <td>Acconto Contributi INPS</td>
                    <td>${accontoInps}</td>
                </tr>
            </table>
        `;

        // Popolare le schede
        popolaSchede({
            redditoLordo,
            redditoNetto,
            impostaSostitutiva,
            contributiInps,
            accontoImposta,
            accontoInps,
            contributiFissi,
            contributiVariabili,
            mesiAttivi,
            dataApertura,
            cassaInps,
            riduzione35,
            aliquotaImposta,
            coefficienteRedditivita
        });
    }

    function popolaSchede(dati) {
        // Scheda "Come si Calcolano?"
        const tab1 = document.getElementById('tab-1');
        tab1.innerHTML = `
            <p>In regime forfettario paghi l'imposta sostitutiva, che nel tuo caso è del ${dati.aliquotaImposta}%.</p>
            <p>L'imposta come i contributi li paghi non sul totale incassato ma sul ${dati.coefficienteRedditivita}% (che è il coefficiente di redditività del tuo codice ATECO).</p>
            <p>Quindi paghi il ${dati.aliquotaImposta}% di imposta e il ${getAliquotaContributi(dati)}% di contributi INPS non sul totale incassato (${dati.redditoLordo}€) ma sul tuo incassato per il coefficiente di redditività.</p>
            <p><strong>${dati.redditoLordo}€ x ${dati.coefficienteRedditivita}% = ${dati.redditoNetto}€ (reddito netto imponibile)</strong></p>
            <p>Nota bene:</p>
            <ul>
                <li>Se nell'anno di riferimento hai versato dei contributi, questi vengono detratti dal tuo reddito netto.</li>
                <li>Se avevi versato gli acconti nell'anno precedente, questi vengono scalati dai saldi che devi versare quest'anno.</li>
            </ul>
            <h3>Esempio di calcolo:</h3>
            <p>Per un incasso di ${dati.redditoLordo}€, il ${dati.coefficienteRedditivita}% corrisponde a ${dati.redditoNetto}€. Su questo importo, dovrai pagare:</p>
            <ul>
                <li>Imposta sostitutiva: ${dati.aliquotaImposta}% su ${dati.redditoNetto}€, che equivale a ${dati.impostaSostitutiva}€.</li>
                <li>Contributi INPS: ${getAliquotaContributi(dati)}% su ${dati.redditoNetto}€, che equivale a ${dati.contributiInps}€.</li>
            </ul>
            <p>Quindi, a livello di saldo, pagherai ${dati.impostaSostitutiva + dati.contributiInps}€ (di cui ${dati.impostaSostitutiva}€ di imposta e ${dati.contributiInps}€ di contributi).</p>
            <h3>Acconti:</h3>
            <p>Oltre al saldo, dovrai versare anche gli acconti per l’anno successivo:</p>
            <ul>
                <li>Imposta sostitutiva: pagherai il 100% dell'importo del saldo come acconto, quindi ulteriori ${dati.accontoImposta}€.</li>
                <li>Contributi INPS: pagherai ${getPercentualeAcconto(dati)}% dell'importo del saldo come acconto, quindi ${dati.accontoInps}€.</li>
            </ul>
            <h3>Totale complessivo:</h3>
            <ul>
                <li>Saldo totale: ${dati.impostaSostitutiva + dati.contributiInps}€ (di cui ${dati.impostaSostitutiva}€ di imposta e ${dati.contributiInps}€ di contributi)</li>
                <li>Acconti totali: ${dati.accontoImposta + dati.accontoInps}€ (di cui ${dati.accontoImposta}€ di imposta e ${dati.accontoInps}€ di contributi)</li>
                <li>Importo complessivo (saldo + acconti): ${dati.impostaSostitutiva + dati.contributiInps + dati.accontoImposta + dati.accontoInps}€</li>
            </ul>
            <p>Questi importi sono indicativi e, in sede di dichiarazione dei redditi, verranno calcolati con precisione.</p>
        `;

        // Scheda "Scadenza Pagamenti"
        const tab2 = document.getElementById('tab-2');
        tab2.innerHTML = `
            <h3>Dettaglio dei Pagamenti</h3>
            <p><strong>Dettaglio dei pagamenti per l'anno ${new Date().getFullYear()}</strong></p>
            <p>Hai guadagnato ${dati.redditoLordo}€ nel ${new Date().getFullYear()}.</p>
            <h4>Calcolo del Reddito Netto:</h4>
            <p>Reddito Lordo (${dati.redditoLordo}€) x Coefficiente di Redditività (${dati.coefficienteRedditivita}%) = ${dati.redditoNetto}€</p>
            <h4>Calcolo dell'Imposta Sostitutiva:</h4>
            <p>Reddito Netto (${dati.redditoNetto}€) x Aliquota Imposta Sostitutiva (${dati.aliquotaImposta}%) = ${dati.impostaSostitutiva}€</p>
            <h4>Calcolo dei Contributi INPS (${getCassaInpsNome(dati.cassaInps)}):</h4>
            ${getDettaglioContributi(dati)}
            <h3>Tasse da pagare:</h3>
            <ul>
                <li>Saldo imposta sostitutiva sul ${new Date().getFullYear()} (${dati.impostaSostitutiva}€) da pagare entro il 30 giugno ${new Date().getFullYear() + 1}.</li>
                <li>Acconto imposta sostitutiva per il ${new Date().getFullYear() + 1} (${dati.accontoImposta}€) da pagare in due rate:
                    <ul>
                        <li>Prima rata (${Math.round(dati.accontoImposta / 2)}€) entro il 30 giugno ${new Date().getFullYear() + 1}.</li>
                        <li>Seconda rata (${Math.round(dati.accontoImposta / 2)}€) entro il 30 novembre ${new Date().getFullYear() + 1}.</li>
                    </ul>
                </li>
            </ul>
            ${getDettaglioContributiFissi(dati)}
        `;

        // Scheda "Dettaglio Pagamenti"
        const totaleTasseContributi = dati.impostaSostitutiva + dati.contributiInps;
        const totaleAcconti = dati.accontoImposta + dati.accontoInps;
        const totaleDaVersare = totaleTasseContributi + totaleAcconti;
        const percentualeTasse = Math.round((totaleTasseContributi / dati.redditoLordo) * 100);
        const percentualeAcconti = Math.round((totaleAcconti / dati.redditoLordo) * 100);
        const percentualeTotale = Math.round((totaleDaVersare / dati.redditoLordo) * 100);

        const tab3 = document.getElementById('tab-3');
        tab3.innerHTML = `
            <h3>Riepilogo dei Pagamenti:</h3>
            <ul>
                <li><strong>Totale tasse e contributi effettivi sul ${new Date().getFullYear()}:</strong> ${totaleTasseContributi}€ (circa il ${percentualeTasse}% del tuo reddito lordo)</li>
                <li><strong>Totale acconti per il ${new Date().getFullYear() + 1}:</strong> ${totaleAcconti}€ (circa il ${percentualeAcconti}% del tuo reddito lordo)</li>
                <li><strong>Totale da versare complessivamente:</strong> ${totaleDaVersare}€ (circa il ${percentualeTotale}% del tuo reddito lordo)</li>
            </ul>
            <p>Nota: Gli acconti sono un anticipo sulle tasse e contributi dell'anno successivo (${new Date().getFullYear() + 1}) e non rappresentano un costo aggiuntivo.</p>
        `;
    }

    function getAliquotaContributi(dati) {
        if (dati.cassaInps === 'gestione-separata') {
            return '26%';
        } else if (dati.cassaInps === 'commercianti') {
            return '24%';
        } else if (dati.cassaInps === 'artigiani') {
            return '24%';
        } else {
            return '';
        }
    }

    function getPercentualeAcconto(dati) {
        if (dati.cassaInps === 'gestione-separata') {
            return '80';
        } else {
            return '100';
        }
    }

    function getCassaInpsNome(cassa) {
        if (cassa === 'commercianti') {
            return 'Commercianti';
        } else if (cassa === 'artigiani') {
            return 'Artigiani';
        } else {
            return 'Gestione Separata INPS';
        }
    }

    function getDettaglioContributi(dati) {
        if (dati.cassaInps === 'gestione-separata') {
            return `<p>Contributi INPS: 26% su ${dati.redditoNetto}€, che equivale a ${dati.contributiInps}€.</p>`;
        } else {
            return `<p>Contributi Fissi (stabiliti da INPS): ${dati.contributiFissi}€</p>
            ${dati.contributiVariabili > 0 ? `<p>Contributi Variabili: ${dati.contributiVariabili}€</p>` : ''}
            <p>Totale Contributi INPS = ${dati.contributiInps}€</p>`;
        }
    }

    function getDettaglioContributiFissi(dati) {
        if (dati.cassaInps === 'commercianti' || dati.cassaInps === 'artigiani') {
            return `
            <h3>Contributi previdenziali:</h3>
            <p>Contributi fissi INPS sul ${new Date().getFullYear()} (${dati.contributiFissi}€) da pagare in quattro rate:</p>
            <ul>
                <li>Rata 1 (${Math.round(dati.contributiFissi / 4)}€) entro il 16 maggio ${new Date().getFullYear()}.</li>
                <li>Rata 2 (${Math.round(dati.contributiFissi / 4)}€) entro il 20 agosto ${new Date().getFullYear()}.</li>
                <li>Rata 3 (${Math.round(dati.contributiFissi / 4)}€) entro il 16 novembre ${new Date().getFullYear()}.</li>
                <li>Rata 4 (${Math.round(dati.contributiFissi / 4)}€) entro il 16 febbraio ${new Date().getFullYear() + 1}.</li>
            </ul>
            `;
        } else {
            return '';
        }
    }

    // Gestione delle schede
    const tabs = document.querySelectorAll('.tab-link');
    const tabContents = document.querySelectorAll('.tab-content');

    tabs.forEach(function(tab) {
        tab.addEventListener('click', function() {
            const tabId = this.getAttribute('data-tab');

            tabs.forEach(function(node) {
                node.classList.remove('current');
            });

            tabContents.forEach(function(node) {
                node.classList.remove('current');
            });

            this.classList.add('current');
            document.getElementById(tabId).classList.add('current');
        });
    });
});

    </script>
</body>
</html>
