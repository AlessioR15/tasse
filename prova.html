<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Editor di testo con indentazione sincronizzata</title>
    <style>
        textarea {
            width: 100%;
            height: 300px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>

<h2>Editor di testo con indentazione sincronizzata</h2>
<textarea id="textInput"></textarea>

<script>
    const textInput = document.getElementById('textInput');

    textInput.addEventListener('input', function(e) {
        // Ottieni la posizione del cursore
        const cursorPosition = textInput.selectionStart;

        // Ottieni il testo fino alla posizione del cursore
        const textBeforeCursor = textInput.value.substring(0, cursorPosition);

        // Trova l'inizio della riga corrente
        const lastNewlineIndex = textBeforeCursor.lastIndexOf('\n');
        const currentLineStart = lastNewlineIndex + 1;

        // Ottieni la linea corrente
        const currentLine = textInput.value.substring(currentLineStart, cursorPosition);

        // Trova gli spazi iniziali della linea corrente
        const lineMatch = currentLine.match(/^(\s*)/);
        if (lineMatch) {
            const leadingSpaces = lineMatch[1];

            // Dividi il testo in linee
            const lines = textInput.value.split('\n');

            // Applica gli stessi spazi iniziali a tutte le linee
            const newText = lines.map(line => leadingSpaces + line.trimStart()).join('\n');

            // Calcola la differenza di lunghezza
            const lengthDifference = newText.length - textInput.value.length;

            // Aggiorna il testo nell'area di testo
            textInput.value = newText;

            // Riposiziona il cursore
            const newCursorPosition = cursorPosition + lengthDifference;
            textInput.selectionStart = newCursorPosition;
            textInput.selectionEnd = newCursorPosition;
        }
    });
</script>

</body>
</html>
